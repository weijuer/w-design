@import '../../../../styles/variables.css';

:where(.web-tooltip) {
    --web-tooltip-bg: #fff;
    --web-tooltip-gap: 8px;
}

.web-tooltip {
    --web-tooltip-distance: 1em;
    --web-tooltip-size: 1.25em;

    margin: 0;
    padding: var(--w-space-xs);
    width: fit-content;
    max-width: 15rem;
    max-height: calc(anchor-size(block) * 3);
    border-radius: var(--w-radius-medium);
    background-color: light-dark(#fff, #0e1217);
    color: light-dark(#0e1217, #fff);

    position: absolute;
    inset: auto;
    z-index: 0;
    position-anchor: var(--web-anchor);
    position-try:
        flip-block,
        flip-inline,
        flip-block flip-inline;
    position-try-fallbacks:
        flip-block,
        flip-inline,
        flip-block flip-inline;

    &.web-tooltip--with-arrow {
        &::before {
            content: '';
            position: absolute;
            z-index: -1;
            width: var(--web-tooltip-size);
            height: var(--web-tooltip-size);
            background-color: inherit;

            clip-path: shape(
                from top left,
                curve to 50% 50% with 50% 10%,
                curve to 100% 0% with 50% 10%
            );
        }
    }

    &.web-tooltip--area {
        position-area: var(--web-tooltip--area);
        margin: var(--web-tooltip--margin);
    }

    &.web-tooltip--top {
        bottom: calc(anchor(top) + var(--web-tooltip-size) * 0.5);
        justify-self: anchor-center;

        &::before {
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
        }
    }

    &.web-tooltip--top-start {
        bottom: calc(anchor(top) + var(--web-tooltip-size) * 0.5);
        left: calc(anchor(left) - var(--web-tooltip-size) * 0.5);

        &::before {
            top: 100%;
            left: var(--web-tooltip-size);
            transform: translateX(0%);
        }
    }

    &.web-tooltip--top-end {
        bottom: calc(anchor(top) + var(--web-tooltip-size) * 0.5);
        right: calc(anchor(right) - var(--web-tooltip-size) * 0.5);

        &::before {
            top: 100%;
            right: var(--web-tooltip-size);
            transform: translateX(0%);
        }
    }

    &.web-tooltip--bottom {
        top: calc(anchor(bottom) + var(--web-tooltip-size) * 0.5);
        justify-self: anchor-center;

        &::before {
            bottom: calc(100% - 0.5px);
            left: 50%;
            transform: translateX(-50%) rotate(180deg);
        }
    }

    &.web-tooltip--bottom-start {
        top: calc(anchor(bottom) + var(--web-tooltip-size) * 0.5);
        left: calc(anchor(left) - var(--web-tooltip-size) * 0.5);

        &::before {
            bottom: 100%;
            left: var(--web-tooltip-size);
            transform: rotate(180deg);
        }
    }

    &.web-tooltip--bottom-end {
        top: calc(anchor(bottom) + var(--web-tooltip-size) * 0.5);
        right: calc(anchor(right) - var(--web-tooltip-size) * 0.5);

        &::before {
            bottom: 100%;
            right: var(--web-tooltip-size);
            transform: rotate(180deg);
        }
    }

    &.web-tooltip--left {
        right: calc(anchor(left) + var(--web-tooltip-size) * 0.5);
        align-self: anchor-center;

        &::before {
            left: 100%;
            top: 50%;
            transform: translateY(-50%) rotate(270deg);
        }
    }

    &.web-tooltip--left-start {
        right: calc(anchor(left) + var(--web-tooltip-size) * 0.5);
        top: calc(anchor(top) - var(--web-tooltip-size) * 0.5);

        &::before {
            left: 100%;
            top: calc(var(--web-tooltip-size) * 0.5);
            transform: rotate(270deg);
        }
    }

    &.web-tooltip--left-end {
        right: calc(anchor(left) + var(--web-tooltip-size) * 0.5);
        bottom: calc(anchor(bottom) - var(--web-tooltip-size) * 0.5);

        &::before {
            left: 100%;
            bottom: calc(var(--web-tooltip-size) * 0.5);
            transform: rotate(270deg);
        }
    }

    &.web-tooltip--right {
        left: calc(anchor(right) + var(--web-tooltip-size) * 0.5);
        align-self: anchor-center;

        &::before {
            right: 100%;
            top: 50%;
            transform: translateY(-50%) rotate(90deg);
        }
    }

    &.web-tooltip--right-start {
        left: calc(anchor(right) + var(--web-tooltip-size) * 0.5);
        top: calc(anchor(top) - var(--web-tooltip-size) * 0.5);

        &::before {
            right: 100%;
            top: calc(var(--web-tooltip-size) * 0.5);
            transform: rotate(90deg);
        }
    }

    &.web-tooltip--right-end {
        left: calc(anchor(right) + var(--web-tooltip-size) * 0.5);
        bottom: calc(anchor(bottom) - var(--web-tooltip-size) * 0.5);

        &::before {
            right: 100%;
            bottom: calc(var(--web-tooltip-size) * 0.5);
            transform: rotate(90deg);
        }
    }

    /* 动画过渡 */
    &.fade-enter-active,
    &.fade-leave-active {
        transition:
            opacity 0.3s ease,
            transform 0.3s ease;
    }

    &.fade-enter-from,
    &.fade-leave-to {
        opacity: 0;
        transform: scale(0.9);
    }

    /* 缩放过渡 */
    &.scale-enter-active,
    &.scale-leave-active {
        transition:
            opacity 0.2s ease,
            transform 0.2s ease;
    }

    &.scale-enter-from {
        opacity: 0;
        transform: scale(0.8);
    }

    &.scale-leave-to {
        opacity: 0;
        transform: scale(0.8);
    }

    /* 滑动过渡 */
    &.slide-enter-active,
    &.slide-leave-active {
        transition:
            opacity 0.3s ease,
            transform 0.3s ease;
    }

    &.slide-enter-from {
        opacity: 0;
        transform: translateY(-10px);
    }

    &.slide-leave-to {
        opacity: 0;
        transform: translateY(-10px);
    }
}
